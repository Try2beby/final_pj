# 后端处理说明

## 业务规则

### 子图挖掘业务规则

1. 建议主要在起始节点3跳关联内挖掘网络资产子图。
2. 建议参考边的关联强度挖掘网络资产子图。对于关联强度较弱的边指向的目标节点，不建议挖掘其1跳以外的节点；对于关联强度一般的边指向的目标节点，不建议挖掘其2跳以外节点。
3. 建议根根据实际场景丰富或过滤网络资产子图，比如：对于某些节点，允许加入与之关联的3跳外节点；又比如：当一个节点有成百上千个同类型邻居节点（关联关系类型也一样）时，可以适当过滤其邻居节点，以减少子图总体规模。
4. 建议根根据实际场景丰富或过滤网络资产子图，比如：对于某些节点，允许加入与之关联的3跳外节点；又比如：当一个节点有成百上千个同类型邻居节点（关联关系类型也一样）时，可以适当过滤其邻居节点，以减少子图总体规模。

### 核心网络资产识别业务规则

1. 如果某个网络资产50%以上的邻边关联强度较弱，则该资产不被认为是核心网络资产。
2. 同时关联2个以上IP地址的Domain网络资产很大概率使用了内容分发网络。因此，Domain网络资产所关联的多个IP地址不被认为是核心网络资产。

### 关键链路识别业务规则

1. 两个核心网络资产间长度大于4跳的路径不被认为是关键链路。
2. 两个核心网络资产间存在多条路径时，路径越短越重要。
3. 两个核心网络资产间路径的关联强度越强则越重要。

## 数据文件夹说明

路径 `main\data`

原始数据 `Node.csv`, `Link.csv` 应该放在该路径下。（这两个文件未被添加到 repo 中）

- `communities` 存放了对原始图进行社区检测的结果，一共891个 community。存放的数据为节点集
- `community_subgraphs` 每个社区节点集对应的子图
- `cache` 每个文件是：把单个团伙所有线索所在的 community 合并，得到的子图
  - 相比原数据，为每条边增加了 `weight`, 各个重要程度分别对应 `0.8 0.6 0.4 0.2`

- `subgraph` 每个文件是：以单个团伙所有线索为起点，在原始数据中搜索3跳内的节点，再经过一定的筛选得到的子图。（看作无向图是连通的）
  
  - 筛选规则，使用了子图挖掘业务规则。对于关联强度较弱的边指向的目标节点，不建议挖掘其1跳以外的节点；对于关联强度一般的边指向的目标节点，不建议挖掘其2跳以外节点。
  
  - 为每个节点计算了 `pagerank` 和 `betweenness`，值越高表示节点越重要
  
  - 按业务规则
  
    - 如果某个网络资产50%以上的邻边关联强度较弱，则该资产不被认为是核心网络资产
    - 同时关联2个以上IP地址的Domain网络资产很大概率使用了内容分发网络。因此，Domain网络资产所关联的多个IP地址不被认为是核心网络资产
  
    初步判断了是否为核心资产（筛选出来的节点大都是核心资产，`is_core = True`）
  
# TO DO

- 完善筛选子图的方案
- 识别关键链路

